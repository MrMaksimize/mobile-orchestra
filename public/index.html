<!doctype html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="static/animate.css">
    <style type="text/css">
      body {
        background: url('static/rainbow_white.gif');
      }
      .cowbell {
        background: url('static/cowbell_trans.png');
        background-repeat: no-repeat;
        background-size: contain;
        height: 200px;
        margin:0 auto;
        margin-top:150px;
        padding-top:50px;
        width:150px;
      }
      .subscription-count {
        background-color:rgba(0,0,0,0.7);
        border-radius:30px;
        color:white;
        font-size:20pt;
        margin:0 auto;
        padding:10px;
        text-align:center;
        width:30px;
      }
    </style>
    <title>More Cowbell</title>
    <script src="/socket.io/socket.io.js"></script>
    <script>
          </script>
  </head>
  <body>
    <div id="cowbell" class="cowbell">
      <div class="subscription-count">
        0
      </div>
    </div>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script>
      function updateCount(count) {
        $('.subscription-count').text(count);
      }

      $(document).ready(function() {
        var socket = io.connect('/phone');
        socket.on('connect', function (e) {
          console.log('Connected.');
        });

        socket.on('updatePhoneCount', function(phoneCount) {
          console.log('Got ' + phoneCount + ' Active Phones.');
          updateCount(phoneCount);
        });

        animateFinishedEvent = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';

        var audioElement = document.createElement('audio');
        audioElement.setAttribute('src', 'sound/cowbell.mp3');

        $("#cowbell").bind(animateFinishedEvent, function() {
          $("#cowbell").removeClass('animated shake');
          audioElement.stop();
        });
        $("#cowbell").bind('click', function() {
          $('#cowbell').addClass('animated shake');
          audioElement.play();
        });
      });
    </script>
  </body>
</html>
